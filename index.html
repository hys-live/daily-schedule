<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Google Sheet Data Table</title>
  <!-- Bootstrap CSS CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { margin: 2em;}
  </style>
</head>
<body>
  <h1>Google Sheet Data</h1>
  <div class="table-responsive">
    <table class="table table-striped" id="sheetTable">
      <thead></thead>
      <tbody></tbody>
    </table>
  </div>
  <script>
    // Replace with your Google Sheet ID
    const sheetID = '1gCg_mssOJUWJ_7HF6SRppBPEm_JEUrGpIV3563JfWSU';
    const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json`;

function parseGoogleDate(val) {
  const m = typeof val === 'string' && val.match(/^Date\(([\d,]+)\)$/);
  if (m) {
    const parts = m[1].split(',').map(Number);
    const dateObj = new Date(...parts);
    if (parts.length > 3) return dateObj.toLocaleString();
    return dateObj.toLocaleDateString();
  }
  return val;
}

fetch(url)
  .then(res => res.text())
  .then(text => {
    const json = JSON.parse(text.match(/google\.visualization\.Query\.setResponse\(([\s\S\w]+)\)/)[1]);
    const data = json.table;
    const cols = data.cols.map(col => col.label);
    const rows = data.rows.map(row =>
      row.c.map(cell => cell?.f ?? parseGoogleDate(cell?.v) ?? '')
    );
    document.querySelector('#sheetTable thead').innerHTML =
      '<tr>' + cols.map(col => `<th>${col}</th>`).join('') + '</tr>';
    document.querySelector('#sheetTable tbody').innerHTML =
      rows.map(row =>
        '<tr>' + row.map(cell => `<td>${cell}</td>`).join('') + '</tr>'
      ).join('');
  })
  .catch(err => {
    document.getElementById('sheetTable').outerHTML = `<div class="alert alert-danger">Error loading data. Is your sheet public?</div>`;
    console.error(err);
  });
      });
  </script>
</body>
</html>